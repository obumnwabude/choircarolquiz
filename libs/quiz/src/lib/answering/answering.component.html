<mat-progress-bar
  color="accent"
  mode="determinate"
  [value]="((currentQ + 1) / questions.length) * 100"
></mat-progress-bar>

<p class="countdown mat-elevation-z1" [class.red-countdown]="secondsLeft < 10">
  <span [class.text-lg]="!isInCheck">Time Left:&nbsp;</span>
  <span
    [class.text-2xl]="!isInCheck"
    [class.font-bold]="!isInCheck"
    [class.blinker]="!isInCheck && secondsLeft < 10 && secondsLeft > 0"
    >00:{{ secondsLeft | number: '2.0-0' }}</span
  >
</p>

<form
  (ngSubmit)="checkAnswer()"
  class="max-w-screen-sm mx-auto mt-20 px-8"
  *ngIf="hasSetQuestions"
>
  <h2 class="font-bold text-2xl underline">
    Question {{ currentQ + 1 }} of {{ questions.length }}
  </h2>
  <p class="mb-8 select-none">{{ questions[currentQ].value }}</p>
  <mat-radio-group (ngModel)="(selectedIndex)" required>
    <div
      *ngFor="let answer of answers"
      class="
        answer
        py-3
        px-4
        mb-5
        mx-auto
        border-2 border-gray-300
        flex
        items-center
      "
      (click)="selectAnswer(answer.index)"
      [class.selected]="!isInCheck && answer.index === selectedIndex"
      [class.correct]="
        isInCheck &&
        answer.index === selectedIndex &&
        answer.index === correctIndex
      "
      [class.wrong]="
        isInCheck &&
        answer.index === selectedIndex &&
        answer.index !== correctIndex
      "
      [class.correct-inform]="
        isInCheck &&
        answer.index !== selectedIndex &&
        answer.index === correctIndex
      "
    >
      <mat-radio-button
        [value]="answer.index"
        [checked]="answer.checked"
        (change)="selectAnswer(answer.index)"
        *ngIf="!isInCheck"
      ></mat-radio-button>
      <span
        *ngIf="
          isInCheck &&
          answer.index !== selectedIndex &&
          answer.index !== correctIndex
        "
        class="space-filler"
      ></span>
      <mat-icon
        *ngIf="isInCheck && answer.index === correctIndex"
        class="correct-icon"
        >task_alt</mat-icon
      >
      <mat-icon
        *ngIf="
          isInCheck &&
          answer.index === selectedIndex &&
          answer.index !== correctIndex
        "
        class="wrong-icon"
        >highlight_off</mat-icon
      >
      <span class="select-none">{{ answer.value }}</span>
    </div>
  </mat-radio-group>

  <div class="text-center pt-2">
    <button
      mat-raised-button
      color="accent"
      *ngIf="!isInCheck"
      [disabled]="selectedIndex === ''"
      (click)="checkAnswer()"
      type="submit"
    >
      Check
    </button>
    <button
      mat-raised-button
      color="accent"
      *ngIf="isInCheck && currentQ + 1 < questions.length"
      (click)="nextQuestion()"
      #nextButton
    >
      Next
    </button>
    <button
      mat-raised-button
      color="accent"
      *ngIf="isInCheck && currentQ + 1 === questions.length"
      (click)="finishQuiz()"
      #finishButton
    >
      Finish
    </button>
  </div>
</form>
